{"version":"0.2.0","body":"function main(\n  workbook: ExcelScript.Workbook,\n  InvoiceNumber: string,\n  Date: string,\n  PaymentMethod: string,\n  ChequeNo: string,\n  JobNo: string,\n  VATRate: string,\n  SalesArray: string = \"[{}]\",\n  CustomerArray: string = \"[{}]\"\n) {\n  // Get the first worksheet\n  let sheet = workbook.getFirstWorksheet();\n  \n  //Update Header of Sales Receipt\n  sheet.getRange(\"G2\").setValue(InvoiceNumber);\n  sheet.getRange(\"G3\").setValue(Date);\n  sheet.getRange(\"B9\").setValue(PaymentMethod);\n  sheet.getRange(\"D9\").setValue(ChequeNo);\n  sheet.getRange(\"E9\").setValue(JobNo);\n  sheet.getRange(\"G27\").setValue(VATRate);\n\n  let ObjCustomer = JSON.parse(CustomerArray);\n\n  //Update Customer Details\n  var ObjCustomerItem = [].concat(ObjCustomer[0][\"Name\"])\n    .concat(ObjCustomer[0][\"CompName\"])\n    .concat(ObjCustomer[0][\"Street\"])\n    .concat(ObjCustomer[0][\"City\"])\n    .concat(ObjCustomer[0][\"Phone\"]);\n\n  console.log(ObjCustomerItem);\n  //sheet.getRange(\"C2:C6\").setValue(ObjCustomerItem);\n  var x=0; //for loop counter and first row number\n  var y=0; //array element counter\n  for (x=2; x < 7; x++) {\n    var SoldCell=\"C\"+x;\n    sheet.getRange(SoldCell).setValue(ObjCustomerItem[y]);\n    y++;\n  }\n\n  //Update Sales Lines\n  let ObjSales = JSON.parse(SalesArray);\n\nvar i=0; //counter for loop\nvar j=12; //starting row for items on invoice\nfor (i = 0; i < ObjSales.length; i++) {\n  var ObjSalesItem = [].concat(ObjSales[i][\"Quantity\"])\n    .concat(ObjSales[i][\"Item No.\"])\n    .concat(ObjSales[i][\"Description\"])\n    .concat(ObjSales[i][\"Unit price\"])\n    .concat(ObjSales[i][\"Discount\"]);\n    var Cell=\"B\"+j+\":F\"+j;\n    j++;\n  sheet.getRange(Cell).setValue([ObjSalesItem]);\n}\n\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[{\"name\":\"InvoiceNumber\",\"index\":0},{\"name\":\"Date\",\"index\":1},{\"name\":\"PaymentMethod\",\"index\":2},{\"name\":\"ChequeNo\",\"index\":3},{\"name\":\"JobNo\",\"index\":4},{\"name\":\"VATRate\",\"index\":5},{\"name\":\"SalesArray\",\"index\":6},{\"name\":\"CustomerArray\",\"index\":7}],\"parameterSchema\":{\"type\":\"object\",\"required\":[\"InvoiceNumber\",\"Date\",\"PaymentMethod\",\"ChequeNo\",\"JobNo\",\"VATRate\",\"SalesArray\",\"CustomerArray\"],\"properties\":{\"InvoiceNumber\":{\"type\":\"string\"},\"Date\":{\"type\":\"string\"},\"PaymentMethod\":{\"type\":\"string\"},\"ChequeNo\":{\"type\":\"string\"},\"JobNo\":{\"type\":\"string\"},\"VATRate\":{\"type\":\"string\"},\"SalesArray\":{\"type\":\"string\",\"default\":\"[{}]\"},\"CustomerArray\":{\"type\":\"string\",\"default\":\"[{}]\"}}},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":1}"}